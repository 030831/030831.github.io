---
layout: post
title: "2. ì„œë¸”ë¦¿ê³¼ http ì‘ë‹µ , ìš”ì²­"
categories: Gaounuri_Spring_Study
---

[Project Code File](https://github.com/030831/Java_Project/tree/master/servlet)

> ### ğŸ“Œ ëª©ì°¨

1. ì„œë¸”ë¦¿ ì‚¬ìš©í•˜ê¸°

2. `HttpServletRequest` ê¸°ë³¸ ì‚¬ìš©ë²•

3. `HttpServletRequest` ê°œìš”

4. `HTTP` ìš”ì²­ ë°ì´í„° - `GET` ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°

5. `HTTP` ìš”ì²­ ë°ì´í„° - `POST - HTML Form`

6. `HTTP` ìš”ì²­ ë°ì´í„° - `API` ë©”ì‹œì§€ ë°”ë”” - ë‹¨ìˆœ í…ìŠ¤íŠ¸

7. `HTTP` ìš”ì²­ ë°ì´í„° - `API` ë©”ì‹œì§€ ë°”ë”” - `JSON`

8. `HttpServletResponse` - ê¸°ë³¸ ì‚¬ìš©ë²•

9. `HTTP` ì‘ë‹µ ë°ì´í„° - ë‹¨ìˆœ í…ìŠ¤íŠ¸, `HTML`

10. `HTTP` ì‘ë‹µ ë°ì´í„° - `API JSON`


> #### ì‚¬ìš© í”„ë¡œê·¸ë¨ & ì •ë³´

* `JDK` : 11ë²„ì „

* `postman`

* `Spring` : 2.7.13 ë²„ì „ , `War package` , `gradle`

* `lombok`

```java
// build.gradle 

plugins {
	id 'java'
	id 'war'
	id 'org.springframework.boot' version '2.7.13'
	id 'io.spring.dependency-management' version '1.0.15.RELEASE'
}

group = 'hello'
version = '0.0.1-SNAPSHOT'

java {
	sourceCompatibility = '11'
}

configurations {
	compileOnly {
		extendsFrom annotationProcessor
	}
}

repositories {
	mavenCentral()
}

dependencies {
	implementation 'org.springframework.boot:spring-boot-starter-web'
	compileOnly 'org.projectlombok:lombok'
	annotationProcessor 'org.projectlombok:lombok'
	providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat'
	testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

tasks.named('test') {
	useJUnitPlatform()
}
```


> #### ğŸ“Œ ì„œë¸”ë¦¿ ì‚¬ìš©í•˜ê¸°

ì„œë¸”ë¦¿ì€ ìë°”ì—ì„œ ë™ì  ì›¹í˜ì´ì§€ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” ê¸°ìˆ ì´ë‹¤.

ì„œë¸”ë¦¿ì€ í†°ìº£ ê°™ì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ë¥¼ ì§ì ‘ ì„¤ì¹˜í•˜ê³ , ê·¸ ìœ„ì— ì„œë¸”ë¦¿ ì½”ë“œë¥¼ í´ë˜ìŠ¤ íŒŒì¼ë¡œ ë¹Œë“œí•´ì„œ ì˜¬ë¦° ë‹¤ìŒ, í†°ìº£ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ë©´ ëœë‹¤. í•˜ì§€ë§Œ ì´ ê³¼ì •ì€ ë§¤ìš° ë²ˆê±°ë¡­ë‹¤.
ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” í†°ìº£ ì„œë²„ë¥¼ ë‚´ì¥í•˜ê³  ìˆìœ¼ë¯€ë¡œ, í†°ìº£ ì„œë²„ ì„¤ì¹˜ ì—†ì´ í¸ë¦¬í•˜ê²Œ ì„œë¸”ë¦¿ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.


```java
// hello.servlet.ServletApplication

@ServletComponentScan // ì„œë¸”ë¦¿ ìë™ ë“±ë¡
@SpringBootApplication
public class ServletApplication {

	public static void main(String[] args) {
		SpringApplication.run(ServletApplication.class, args);
	}
}
```


ê¸°ì¡´ì˜ ìŠ¤í”„ë§ ì‹¤í–‰ ì½”ë“œì—ì„œ  ì„œë¸”ë¦¿ ìë™ ë“±ë¡ ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•´ì¤€ë‹¤.


```java
//hello.servlet.basic.HelloServlet

@WebServlet(name = "helloServlet" , urlPatterns = "/hello")
public class HelloServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        System.out.println("HelloServlet.service");
        System.out.println("request = " + request);
        System.out.println("response = " + response);

        String username = request.getParameter("username");
        System.out.println("username = " + username);

        response.setContentType("text/plain");
        response.setCharacterEncoding("utf-8");
        response.getWriter().write("hello " + username);
    }
}
```

`@WebServlet` ì• ë…¸í…Œì´ì…˜ì„ í†µí•´ ì„œë¸”ë¦¿ ì´ë¦„ê³¼ `url` ê²½ë¡œë¥¼ ì§€ì •í•´ì¤„ ìˆ˜ ìˆë‹¤.
ì„œë¸”ë¦¿ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” í•­ìƒ `HttpServlet` **í´ë˜ìŠ¤ë¥¼ ìƒì† í•´ì•¼í•œë‹¤.**

ì´í›„ `service` í´ë˜ìŠ¤ë¥¼ ì˜¤ë²„ë¼ì´ë”©ì„ í•˜ê³  êµ¬í˜„ì„ í•´ì¤€ë‹¤

`HttpServletRequest request, HttpServletResponse response`
ì´ë•Œ ë‘ê°œì˜ íŒŒë¼ë¯¸í„°ê°€ ì¡´ì¬í•˜ëŠ”ë° ì´ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ì—¬ëŸ¬ê°€ì§€ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

![image](https://github.com/030831/030831.github.io/assets/101914089/de892077-7d58-483a-b6db-8716778ad288)

ìœ„ì™€ê°™ì´ `localhost` ì— ì¿¼ë¦¬íŒŒë¼ë¯¸í„°í˜•ì‹ìœ¼ë¡œ `http` ìš”ì²­ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´ `response.getWriter().write()` ë¥¼ í†µí•´ ì‘ë‹µë©”ì‹œì§€ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.


![image](https://github.com/030831/030831.github.io/assets/101914089/9a1f7638-5a4a-452d-962f-50263c19c975)

`resource/application.properties` ê²½ë¡œì— `logging.level.org.apache.coyote.http11=debug` ë‚´ìš©ì„ ì¶”ê°€í•˜ë©´ `http` ìš”ì²­ ë©”ì‹œì§€ ë¡œê·¸ë¥¼ ì½˜ì†”ì°½ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

> #### ğŸ“Œ HttpServletRequest ê¸°ë³¸ ì‚¬ìš©ë²•

ìœ„ì™€ê°™ì€ `http` ìš”ì²­ ë©”ì‹œì§€ë¥¼ ë¶„ì„í•˜ê³  íŒŒì‹±í•´ì„œ ì§ì ‘ ì‘ë‹µë©”ì‹œì§€ë¥¼ ë§Œë“¤ê¸°ì—ëŠ” ë§¤ìš° ì–´ë µë‹¤. ë”°ë¼ì„œ `HttpServletRequest` ê°ì²´ë¥¼ í†µí•´ ê´€ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.
`HttpServletRequest` ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ê³¼ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ë³´ì.

```java
//hello.servlet.basic.request.RequestHeaderServlet

@WebServlet(name = "requestHeaderServlet", urlPatterns = "/request-header")
public class RequestHeaderServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {
        printStartLine(request);
        printHeaders(request);
        printHeaderUtils(request);
        printEtc(request);


    }

    private static void printStartLine(HttpServletRequest request) {
        System.out.println("--- REQUEST-LINE - start ---");
        System.out.println("request.getMethod() = " + request.getMethod()); //GET
        System.out.println("request.getProtocol() = " + request.getProtocol()); //HTTP/1.1
        System.out.println("request.getScheme() = " + request.getScheme()); //http
        // http://localhost:8080/request-header
        System.out.println("request.getRequestURL() = " + request.getRequestURL());
        // /request-header
        System.out.println("request.getRequestURI() = " + request.getRequestURI());
        //username=hi
        System.out.println("request.getQueryString() = " + request.getQueryString());
        System.out.println("request.isSecure() = " + request.isSecure()); //https ì‚¬ìš© ìœ ë¬´
        System.out.println("--- REQUEST-LINE - end ---");
        System.out.println();
    }

    //Header ëª¨ë“  ì •ë³´
    private void printHeaders(HttpServletRequest request) {
        System.out.println("--- Headers - start ---");
        request.getHeaderNames().asIterator()
            .forEachRemaining(headerName -> System.out.println(headerName + ": " + headerName));

        request.getHeader("host"); // í•˜ë‚˜ì˜ ì •ë³´ë§Œ ì¶œë ¥í•˜ê¸°
        System.out.println("--- Headers - end ---");
        System.out.println();
    }

    //Header í¸ë¦¬í•œ ì¡°íšŒ
    private void printHeaderUtils(HttpServletRequest request) {
        System.out.println("--- Header í¸ì˜ ì¡°íšŒ start ---");
        System.out.println("[Host í¸ì˜ ì¡°íšŒ]");
        System.out.println("request.getServerName() = " + request.getServerName()); //Host í—¤ë”
        System.out.println("request.getServerPort() = " + request.getServerPort()); //Host í—¤ë”
        System.out.println();
        System.out.println("[Accept-Language í¸ì˜ ì¡°íšŒ]");
        request.getLocales().asIterator()
            .forEachRemaining(locale -> System.out.println("locale = " + locale));
        System.out.println("request.getLocale() = " + request.getLocale());
        System.out.println();
        System.out.println("[cookie í¸ì˜ ì¡°íšŒ]");
        if (request.getCookies() != null) {
            for (Cookie cookie : request.getCookies()) {
                System.out.println(cookie.getName() + ": " + cookie.getValue());
            }
        }
        System.out.println();
        System.out.println("[Content í¸ì˜ ì¡°íšŒ]");
        System.out.println("request.getContentType() = " + request.getContentType());
        System.out.println("request.getContentLength() = " + request.getContentLength());
        System.out.println("request.getCharacterEncoding() = " + request.getCharacterEncoding());
        System.out.println("--- Header í¸ì˜ ì¡°íšŒ end ---");
        System.out.println();
    }

    private void printEtc(HttpServletRequest request) {
        System.out.println("--- ê¸°íƒ€ ì¡°íšŒ start ---");
        System.out.println("[Remote ì •ë³´]");
        System.out.println("request.getRemoteHost() = " + request.getRemoteHost()); //
        System.out.println("request.getRemoteAddr() = " + request.getRemoteAddr()); //
        System.out.println("request.getRemotePort() = " + request.getRemotePort()); //
        System.out.println();
        System.out.println("[Local ì •ë³´]");
        System.out.println("request.getLocalName() = " + request.getLocalName()); //
        System.out.println("request.getLocalAddr() = " + request.getLocalAddr()); //
        System.out.println("request.getLocalPort() = " + request.getLocalPort()); //
        System.out.println("--- ê¸°íƒ€ ì¡°íšŒ end ---");
        System.out.println();
    }
}
```

```
--- REQUEST-LINE - start ---
request.getMethod() = GET
request.getProtocol() = HTTP/1.1
request.getScheme() = http
request.getRequestURL() = http://localhost:8080/request-header
request.getRequestURI() = /request-header
request.getQueryString() = username=hello
request.isSecure() = false
--- REQUEST-LINE - end ---

--- Headers - start ---
host: host
connection: connection
cache-control: cache-control
sec-ch-ua: sec-ch-ua
sec-ch-ua-mobile: sec-ch-ua-mobile
sec-ch-ua-platform: sec-ch-ua-platform
upgrade-insecure-requests: upgrade-insecure-requests
user-agent: user-agent
accept: accept
sec-fetch-site: sec-fetch-site
sec-fetch-mode: sec-fetch-mode
sec-fetch-user: sec-fetch-user
sec-fetch-dest: sec-fetch-dest
accept-encoding: accept-encoding
accept-language: accept-language
cookie: cookie
--- Headers - end ---

--- Header í¸ì˜ ì¡°íšŒ start ---
[Host í¸ì˜ ì¡°íšŒ]
request.getServerName() = localhost
request.getServerPort() = 8080

[Accept-Language í¸ì˜ ì¡°íšŒ]
locale = ko
locale = en
locale = en_US
request.getLocale() = ko

[cookie í¸ì˜ ì¡°íšŒ]
Idea-96a4e784: a6ebb691-6e80-4c17-b4b9-b0441d2e4999
Idea-e27941a4: a6ebb691-6e80-4c17-b4b9-b0441d2e4999

[Content í¸ì˜ ì¡°íšŒ]
request.getContentType() = null
request.getContentLength() = -1
request.getCharacterEncoding() = UTF-8
--- Header í¸ì˜ ì¡°íšŒ end ---

--- ê¸°íƒ€ ì¡°íšŒ start ---
[Remote ì •ë³´]
request.getRemoteHost() = 0:0:0:0:0:0:0:1
request.getRemoteAddr() = 0:0:0:0:0:0:0:1
request.getRemotePort() = 49398

[Local ì •ë³´]
request.getLocalName() = 0:0:0:0:0:0:0:1
request.getLocalAddr() = 0:0:0:0:0:0:0:1
request.getLocalPort() = 8080
--- ê¸°íƒ€ ì¡°íšŒ end ---
```

ìœ„ì™€ê°™ì€ ì•„ì£¼ ìì„¸í•œ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
ìš”ì²­ì˜ í˜•ì‹ì´ `GET` ë°©ì‹ì´ê³  í”„ë¡œí† ì½œ, ë§í¬ , í¬íŠ¸ , ì–¸ì–´ , ì¿ ê¸° , ì¸ì½”ë”© ë“±ê³¼ ê°™ì€ ì •ë³´ë¥¼ `HttpServletRequest` ê°ì²´ë¥¼ í†µí•´ ì•Œ ìˆ˜ ìˆë‹¤.

> #### ğŸ“Œ HttpServletRequest ê°œìš”

`HTTP` ìš”ì²­ ë©”ì‹œì§€ë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•˜ëŠ” ë°©ë²•ì€ 3ê°€ì§€ê°€ ìˆë‹¤.

![image](https://github.com/030831/030831.github.io/assets/101914089/bf35d5a3-1683-49de-a7aa-38c15b0083aa)


* `GET` : ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°
  * `/url?username=hello&age=20` 
  * ë©”ì‹œì§€ ë°”ë”” ì—†ì´ `URL` ì˜ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ë¥¼ í†µí•´ ì „ë‹¬
  * ê²€ìƒ‰ , í•„í„°ì— ì“°ì„
  
 ![image](https://github.com/030831/030831.github.io/assets/101914089/c36c453b-038e-45a9-8f5f-a4300a861a65)


 * `POST` : `HTML form`
   * `content-type: application/x-www-form-urlencoded`
   * ë©”ì‹œì§€ ë°”ë””ì— ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í˜•ì‹ìœ¼ë¡œ ì „ë‹¬
   * íšŒì›ê°€ì… , ìƒí’ˆì£¼ë¬¸ì— ì‚¬ìš©
   
![image](https://github.com/030831/030831.github.io/assets/101914089/0e8c31e8-c3c7-488a-9fb3-b6095e49acb3)

* `HTTP` : `message body`
   * `HTTP API` ì—ì„œ ì£¼ë¡œ ì‚¬ìš© , `JSON , XML , TEXT`
   * `POST , PUT , PATCH` ìš”ì²­ë§Œ ì‚¬ìš©ê°€ëŠ¥
   
> #### ğŸ“ŒHTTP ìš”ì²­ ë°ì´í„° - GET ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°

* `username = hello , age = 20` ì´ë¼ëŠ” ë°ì´í„°ë¥¼ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë²„ë¡œ ì „ì†¡í•´ë³´ì.

ì„œë²„ì—ì„œëŠ” `HttpServletRequest` ê°€ ì œê³µí•˜ëŠ” ë©”ì„œë“œë¥¼ í†µí•´ ì¿¼ë¦¬íŒŒë¼ë¯¸í„°ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.


```java
//hello.servlet.basic.request.RequestParamServlet

/**
 * 1. íŒŒë¼ë¯¸í„° ì „ì†¡ ê¸°ëŠ¥
 * http://localhost:8080/request-param?username=hello&age=20
 */

@WebServlet(name = "requestParamServlet" , urlPatterns = "/request-param")
public class RequestParamServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("[ì „ì²´ íŒŒë¼ë¯¸í„° ì¡°íšŒ] - start");

        request.getParameterNames().asIterator()
                .forEachRemaining(paramName -> System.out.println(paramName + "=" + request.getParameter(paramName)));
        System.out.println("[ì „ì²´ íŒŒë¼ë¯¸í„° ì¡°íšŒ] - end");
        System.out.println();
        System.out.println("[ë‹¨ì¼ íŒŒë¼ë¯¸í„° ì¡°íšŒ]");
        String username = request.getParameter("username");
        String age = request.getParameter("age");

        System.out.println("age = " + age);
        System.out.println("username = " + username);

        System.out.println("[ì´ë¦„ì´ ê°™ì€ ë³µìˆ˜ íŒŒë¼ë¯¸í„° ì¡°íšŒ] ");
        String[] usernames = request.getParameterValues("username");
        for (String name : usernames) {
            System.out.println("name = " + name);
        }

        response.getWriter().write("ok");
    }
}
```

![image](https://github.com/030831/030831.github.io/assets/101914089/ca933952-c8f5-4763-9a37-9df422c352b1)

```java
request.getParameterNames().asIterator()
.forEachRemaining(paramName -> System.out.println(paramName + "=" + request.getParameter(paramName))); 
// ì „ì²´ ì¡°íšŒ
String username = request.getParameter("username");
String age = request.getParameter("age");
// ë‹¨ì¼ ì¡°íšŒ
```

ì´í„°ë ˆì´í„°ë¥¼ í†µí•´ ì „ì²´ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ê³  `getParameter` ë©”ì„œë“œë¥¼ í†µí•´ ë‹¨ì¼ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤

ë§Œì•½ `username=hello&username=kim` ì²˜ëŸ¼ ì¤‘ë³µ íŒŒë¼ë¯¸í„°ê°€ ì¡´ì¬í•œë‹¤ë©´ ê°€ì¥ ì™¼ìª½ì˜ íŒŒë¼ë¯¸í„° í•˜ë‚˜ë§Œ ì¡°íšŒê°€ ë˜ê³  ì¤‘ë³µíŒŒë¼ë¯¸í„°ê°€ í•„ìš”í•˜ë‹¤ë©´ `getParameterValues` ë¥¼ í†µí•´ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤.

> #### ğŸ“Œ HTTP ìš”ì²­ ë°ì´í„° - POST HTML Form

ì´ë²ˆì—ëŠ” íšŒì›ê°€ì…ì— ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” `HTMP Form` í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ì†¡í•´ë³´ì.

```html
<!DOCTYPE html>
<html>
<head>
 <meta charset="UTF-8">
 <title>Title</title>
</head>
<body>
<form action="/request-param" method="post">
 username: <input type="text" name="username" />
 age: <input type="text" name="age" />
 <button type="submit">ì „ì†¡</button>
</form>
</body>
</html>
```

![image](https://github.com/030831/030831.github.io/assets/101914089/3812096f-7de1-42fc-a6a9-5777c12fcd00)

`content-type` ëŠ” `application/x-www-form-urlencoded` ì´ë‹¤.
ì´ í˜•ì‹ì€ ì•ì„œ `GET` ì—ì„œ ì‚´í´ë³¸ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° í˜•ì‹ê³¼ ë˜‘ê°™ë‹¤.
ë”°ë¼ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„° ì¡°íšŒ ë©”ì„œë“œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

> #### ğŸ“Œ HTTP ìš”ì²­ ë°ì´í„° - API ë©”ì‹œì§€ ë°”ë”” - ë‹¨ìˆœ í…ìŠ¤íŠ¸

`HTTP` ë©”ì‹œì§€ ë°”ë””ì˜ ë°ì´í„°ë¥¼ `InputStream` ì„ ì‚¬ìš©í•´ì„œ ì§ì ‘ ì½ì„ ìˆ˜ ìˆë‹¤.

```java
// hello.servlet.basic.request.RequestBodyStringServlet

@WebServlet(name = "requestBodyStringServlet" , urlPatterns = "/request-body-string")
public class RequestBodyStringServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ServletInputStream inputStream = request.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);

        System.out.println("messageBody = " + messageBody);
        response.getWriter().write("ok");
    }
}
```
`getInputStream()` ë©”ì„œë“œëŠ” ë°”ì´íŠ¸ ì½”ë“œë¥¼ ë°˜í™˜í•˜ê¸° ë•Œë¬¸ì— ë¬¸ìë¡œ ë³´ê¸° ìœ„í•´ì„œëŠ” `utf-8` í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•´ì£¼ì–´ì•¼ í•œë‹¤.

> #### ğŸ“Œ HTTP ìš”ì²­ ë°ì´í„° - API ë©”ì‹œì§€ ë°”ë”” - JSON

ì´ë²ˆì—ëŠ” `http api` ì—ì„œ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” `json` í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì „ë‹¬í•´ë³´ì.

```java
// hello.servlet.basic.HelloData
@Getter @Setter
public class HelloData {
    private String username;
    private int age;
}
```
`json` í˜•ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ íŒŒì‹±í•  ìˆ˜ ìˆê²Œ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤. ì´ë•Œ `lombok` ì„ ì‚¬ìš©í•˜ë©´ `getter,setter` ë¥¼ ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ ëŒ€ì²´í• ìˆ˜ìˆë‹¤.


```java
//hello.servlet.basic.request.RequestBodyJsonServlet;

@WebServlet(name = "requestBodyJsonServlet" , urlPatterns = "/request-body-json")
public class RequestBodyJsonServlet extends HttpServlet {

    private ObjectMapper objectMapper = new ObjectMapper();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ServletInputStream inputStream = request.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);
        System.out.println("messageBody = " + messageBody);
        HelloData helloData = objectMapper.readValue(messageBody, HelloData.class);

        System.out.println("helloData.username = " + helloData.getUsername());
        System.out.println("helloData.age = " + helloData.getAge());
        response.getWriter().write("ok");
    }
}
```

`json` ê²°ê³¼ë¥¼ íŒŒì‹±í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìë°” ê°ì²´ë¡œ ë³€í™˜í•˜ë ¤ë©´ `Jackson,Gson` ê°™ì€ ë³€í™˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì•¼í•˜ëŠ”ë° `Spring boot` ì—ì„œëŠ” `Jackson` ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ `ObjecyMapper` ì„ ì œê³µí•œë‹¤.

![image](https://github.com/030831/030831.github.io/assets/101914089/6e18705e-652a-4a4e-a90e-236224eebbff)

![image](https://github.com/030831/030831.github.io/assets/101914089/20b1f6e5-9694-45f4-a031-af11207ed31c)


`postman` ìœ¼ë¡œ `http` ìš”ì²­ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´ `json` í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì¡°íšŒí•˜ëŠ”ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

> #### ğŸ“Œ HttpServletResponse - ê¸°ë³¸ ì‚¬ìš©ë²•

ì´ë²ˆì—ëŠ” `http` ì‘ë‹µ ë©”ì‹œì§€ë¥¼ ì‘ì„±í•´ë³´ì.

```java
// hello.servlet.basic.reponse.ResponseHeaderServlet;

@WebServlet(name = "responseHeaderServlet" , urlPatterns = "/response-header")
public class ResponseHeaderServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // [status-line]
        response.setStatus(HttpServletResponse.SC_OK);

        // [response-headers]
//        response.setHeader("Content-Type", "text/plain;charset=utf-8");
        response.setHeader("Cache-Control", "no-cache , no-store , must-revalidate");
        response.setHeader("Pragma", "no-cache");
        response.setHeader("my-header", "hello");

        // [Header í¸ì˜ ë©”ì„œë“œ]
//        content(response);
//        cookie(response);
        redirect(response);

        // [Message body]
        PrintWriter writer = response.getWriter();
        writer.println("ok");

    }

    private void content(HttpServletResponse response) {
        //Content-Type: text/plain;charset=utf-8
        //Content-Length: 2
        //response.setHeader("Content-Type", "text/plain;charset=utf-8");
        response.setContentType("text/plain");
        response.setCharacterEncoding("utf-8");
        //response.setContentLength(2); //(ìƒëµì‹œ ìë™ ìƒì„±)
    }

    private void cookie(HttpServletResponse response) {
        //Set-Cookie: myCookie=good; Max-Age=600;
        //response.setHeader("Set-Cookie", "myCookie=good; Max-Age=600");
        Cookie cookie = new Cookie("myCookie", "good");
        cookie.setMaxAge(600); //600ì´ˆ
        response.addCookie(cookie);
    }
    private void redirect(HttpServletResponse response) throws IOException {
        //Status Code 302
        //Location: /basic/hello-form.html
//        response.setStatus(HttpServletResponse.SC_FOUND); //302
//        response.setHeader("Location", "/basic/hello-form.html");
        response.sendRedirect("/basic/hello-form.html");
    }

}
```
ë¨¼ì € `response.setStatus(HttpServletResponse.SC_OK)` ë¥¼ í†µí•´ ìƒíƒœ ì½”ë“œë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤. `OK` ëŠ” 200 ì„ ì˜ë¯¸í•˜ëŠ”ë° ìƒìˆ˜ë¡œ ì ì–´ë„ ë¬´ê´€í•˜ë‹¤.

`response.setHeader("Content-Type", "text/plain;charset=utf-8)` ì™€ ê°™ì´ `setHeader` ë©”ì„œë“œë¥¼ í†¨í•´ `Content-Type` ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤. 

ì¿ í‚¤ë¥¼ í†µí•´ ìƒëª…ì£¼ê¸°ì™€ ì¸ì½”ë”© ì„¤ì •ì„ í•  ìˆ˜ ìˆìœ¼ë©° ë¦¬ë‹¤ì´ë ‰íŠ¸ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

> #### ğŸ“Œ HTTP ì‘ë‹µ ë°ì´í„° - ë‹¨ìˆœ í…ìŠ¤íŠ¸, HTML

`HTTP` ì—ì„œ ì‘ë‹µ ë°ì´í„°ë¥¼ `HTML` ë¡œ í•´ë³´ì. ë‹¨ìˆœ í…ìŠ¤íŠ¸ëŠ” `writer.println("ok")` ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì‘ë‹µí•  ìˆ˜ ìˆë‹¤.


```java
// hello.servlet.basic.reponse.ResponseHtmlServlet;

import java.io.IOException;
import java.io.PrintWriter;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

@WebServlet(name = "responseHtmlServlet" , urlPatterns = "/response-html")
public class ResponseHtmlServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // Content-Type : text/html;charset=utf-8
        response.setContentType("text/html");
        response.setCharacterEncoding("utf-8");

        PrintWriter writer = response.getWriter();
        writer.println("<html>");
        writer.println("<body>");
        writer.println("    <div>ì•ˆë…•?</div>");
        writer.println("<body>");
        writer.println("<html>");
    }
}
```

![image](https://github.com/030831/030831.github.io/assets/101914089/1871d107-9107-4d20-bc22-b12fc2101506)

ìœ„ì™€ê°™ì´ `html` ì½”ë“œë¥¼ ì‘ë‹µë©”ì‹œì§€ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì‹¤ì œ í™”ë©´ì—ì„œëŠ” `html` ì½”ë“œê°€ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤.

> #### ğŸ“Œ HTTP ì‘ë‹µ ë°ì´í„° - API JSON

ì´ë²ˆì—ëŠ” `json` í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì‘ë‹µë©”ì‹œì§€ë¡œ ë³´ë‚´ë³´ì. ì´ë•Œ `content-type` ëŠ” `application/json` ë¡œ ì§€ì •í•´ì•¼í•œë‹¤. `Jackson` ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì œê³µí•˜ëŠ” `objectMapper.writeValueAsString()` ë¥¼ ì‚¬ìš©í•˜ë©´ ê°ì²´ë¥¼ `json` ë¬¸ìë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

```java
//hello.servlet.basic.reponse.ResponseJsonServlet;

@WebServlet(name = "responseJsonServlet" , urlPatterns = "/response-json")
public class ResponseJsonServlet extends HttpServlet {

    private ObjectMapper objectMapper = new ObjectMapper();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        // Content-Type : application/json
        response.setContentType("application/json");
        response.setCharacterEncoding("utf-8");

        HelloData helloData = new HelloData();
        helloData.setUsername("kim");
        helloData.setAge(20);

        // {"username" : "kim" , "age":20}

        String result = objectMapper.writeValueAsString(helloData);
        response.getWriter().write(result);
    }
}
```

![image](https://github.com/030831/030831.github.io/assets/101914089/edcaa32d-89c4-417a-a48c-beec0a046958)

ìœ„ì™€ê°™ì€ `json` í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì‘ë‹µí•¨ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

ì§€ê¸ˆê¹Œì§€ `Servlet` ì„ í†µí•´ `http` ìš”ì²­ë©”ì‹œì§€ì™€ ì‘ë‹µë©”ì‹œì§€ì— ëŒ€í•´ ì•Œì•„ë³´ì•˜ë‹¤.
