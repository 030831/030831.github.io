---
layout: post
title: "8. ìŠ¤í”„ë§ Http ì‘ë‹µ"
categories: Gaounuri_Spring_Study
---
[Project Code File](https://github.com/030831/Java_Project/tree/master/springmvc)

> ### ğŸ“Œ ëª©ì°¨

* `HTTP` ì‘ë‹µ - ì •ì  ë¦¬ì†ŒìŠ¤, ë·° í…œí”Œë¦¿
* `HTTP` ì‘ë‹µ - `HTTP API`, ë©”ì‹œì§€ ë°”ë””ì— ì§ì ‘ ì…ë ¥
* `HTTP` ë©”ì‹œì§€ ì»¨ë²„í„°
* ìš”ì²­ ë§¤í•‘ í—¨ë“¤ëŸ¬ ì–´ëí„° êµ¬ì¡°

> #### ğŸ“Œ HTTP ì‘ë‹µ - ì •ì  ë¦¬ì†ŒìŠ¤, ë·° í…œí”Œë¦¿

`HTTP` ì‘ë‹µì—ëŠ” í¬ê²Œ 3ê°€ì§€ê°€ ì¡´ì¬í•œë‹¤.

1. ì •ì  ë¦¬ì†ŒìŠ¤  ex) `HTML , CSS , JS`

2. ë·° í…œí”Œë¦¿ ex) ë™ì ì¸ ì›¹ ë¸Œë¼ìš°ì €

3. `HTTP` ë©”ì„¸ì§€ ex) `HTTP` ë©”ì‹œì§€ ë°”ë””ì— `json` í˜•ì‹ ë°ì´í„°



`/static , /public , /resources , /META-INF/resources`

ìŠ¤í”„ë§ì—ì„œ ì •ì  ë¦¬ì†ŒìŠ¤ íŒŒì¼ì„ ë³´ê´€í• ë•Œ ìœ„ ê²½ë¡œì—ì„œ ì €ì¥í•´ì•¼í•œë‹¤.

`src/main/resources/templates`

ë˜í•œ ìŠ¤í”„ë§ì—ì„œëŠ” ê¸°ë³¸ì ì¸ ë·° í…œí”Œë¦¿ ê²½ë¡œëŠ” ìœ„ì™€ ê°™ë‹¤.

```java
package hello.springmvc.basic.response;

@Controller
public class ResponseViewController {

    @RequestMapping("/response-view-v1")
    public ModelAndView responseViewV1() {
        ModelAndView mav = new ModelAndView("response/hello").addObject("data", "hello!");

        return mav;
    }

    @RequestMapping("/response-view-v2")
    public String responseViewV2(Model model) {
        model.addAttribute("data", "hello!");
        return "response/hello";
    }

    @RequestMapping("/response/hello")
    public void responseViewV3(Model model) {
        model.addAttribute("data", "hello!");
    }
}
```

`@ResponseBody` ê°€ ì—†ìœ¼ë©´ `response/hello` ë¡œ ë·° ë¦¬ì¡¸ë²„ê°€ ì‹¤í–‰ë˜ì–´ ë·°ë¥¼ ì°¾ê³  ë Œë”ë§ í•œë‹¤.

`ModelAndView` ê°ì²´ì— ê²½ë¡œë¥¼ ì €ì¥í•  ìˆ˜ ìˆê³ 
`String` í˜•ì‹ìœ¼ë¡œ ê²½ë¡œë¥¼ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.
`void` ë°˜í™˜í• ì‹œ ìš”ì²­ `URL` ì„ ì‚¬ìš©í•œë‹¤. í•˜ì§€ë§Œ ì´ëŠ” ëª…ì‹œì„±ì´ ë–¨ì–´ì§„ë‹¤.

> #### ğŸ“Œ HTTP ì‘ë‹µ - HTTP API, ë©”ì‹œì§€ ë°”ë””ì— ì§ì ‘ ì…ë ¥

`HTTP API` ë¥¼ ì œê³µí•˜ëŠ” ê²½ìš°ì—ëŠ” `HTML` ì´ ì•„ë‹ˆë¼ ë°ì´í„°ë¥¼ ì „ë‹¬í•´ì•¼ í•˜ë¯€ë¡œ `HTML` ë©”ì‹œì§€ ë°”ë””ì— `json` ê°™ì€ í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•´ì•¼í•œë‹¤.

```java
package hello.springmvc.basic.response;

@Slf4j
@Controller
public class ResponseBodyController {

    @GetMapping("response-body-string-v1")
    public void responseBodyV1(HttpServletResponse response) throws IOException {
        response.getWriter().write("ok");
    }
}
```
ê°€ì¥ ê¸°ë³¸ì ì¸ ë°©ì‹ì€ `HttpServletResponse` ë¥¼ í†µí•´ ì‘ë‹µí•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.

```java
@GetMapping("/response-body-string-v2")
public ResponseEntity<String> responseBodyV2() throws IOException {
    return new ResponseEntity<>("ok", HttpStatus.OK);
}
```

`ResponseEntity` ì—”í‹°í‹°ëŠ” `HttpEntity` ë¥¼ ìƒì† ë°›ì•˜ëŠ”ë°, `HttpEntity` ëŠ” `HTTP` ë©”ì‹œì§€ì˜ í—¤ë”, ë°”ë””
ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤. `ResponseEntity` ëŠ” ì—¬ê¸°ì— ë”í•´ì„œ `HTTP` ì‘ë‹µ ì½”ë“œë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

```java
@ResponseBody
@GetMapping("/response-body-string-v3")
public String responseBodyV3() {
    return "ok";
}
```
`@ResponseBody` ì—ë…¸í…Œì´ì…˜ì„ ì“°ë©´ ë·°ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  `HTTP` ë©”ì‹œì§€ ì»¨ë²„í„°ë¥¼ í†µí•´ì„œ `HTTP` ë©”ì‹œì§€ë¥¼ ì§ì ‘ ì…ë ¥í•  ìˆ˜ ìˆë‹¤.

```java
@GetMapping("/response-body-json-v1")
public ResponseEntity<HelloData> responseBodyJsonV1() {
    HelloData helloData = new HelloData();
    helloData.setUsername("userA");
    helloData.setAge(20);
    return new ResponseEntity<>(helloData, HttpStatus.OK);
}
```

`ResponseEntity` ë¥¼ ì‚¬ìš©í•˜ë©´ `JSON` í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ë°˜í™˜í•œë‹¤.
ìƒíƒœì½”ë“œë„ ì§€ì • ê°€ëŠ¥í•˜ë‹¤.

`@ResponseStatus(HttpStatus.OK)` ê°™ì€ ì—ë…¸í…Œì´ì…˜ì„ í†µí•´ì„œë„ ìƒíƒœì½”ë“œë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

> #### ğŸ“Œ HTTP ë©”ì‹œì§€ ì»¨ë²„í„°

`HTTP API` ì²˜ëŸ¼ `json` í˜•ì‹ì˜ ë°ì´í„°ë¥¼ `HTTP` ë©”ì‹œì§€ ë°”ë””ì—ì„œ ì§ì ‘ ì½ê±°ë‚˜ ì“°ëŠ” ê²½ìš° `HTTP` ë©”ì‹œì§€ ì»¨ë²„í„°ë¥¼ ì‚¬ìš©í•˜ë©´ í¸ë¦¬í•˜ë‹¤.

ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ëª‡ê°€ì§€ ì£¼ìš”í•œ ë©”ì‹œì§€ ì»¨ë²„í„°ë¥¼ ì œê³µí•œë‹¤.


* `ByteArrayHttpMessageConverter : byte[]` ë°ì´í„°ë¥¼ ì²˜ë¦¬í•œë‹¤.

í´ë˜ìŠ¤ íƒ€ì…: `byte[]` , ë¯¸ë””ì–´íƒ€ì…: `*/*` ,
ìš”ì²­ ì˜ˆ) `@RequestBody byte[] data`
ì‘ë‹µ ì˜ˆ) `@ResponseBody return byte[]`
ì“°ê¸° ë¯¸ë””ì–´íƒ€ì… `application/octet-stream`

* `StringHttpMessageConverter : String` ë¬¸ìë¡œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•œë‹¤.

í´ë˜ìŠ¤ íƒ€ì…: `String` , ë¯¸ë””ì–´íƒ€ì…: `*/*`
ìš”ì²­ ì˜ˆ) `@RequestBody String data`
ì‘ë‹µ ì˜ˆ) `@ResponseBody return "ok"`
ì“°ê¸° ë¯¸ë””ì–´íƒ€ì… `text/plain`

* `MappingJackson2HttpMessageConverter : application/json`

í´ë˜ìŠ¤ íƒ€ì…: ê°ì²´ ë˜ëŠ” `HashMap` , 
ë¯¸ë””ì–´íƒ€ì… `application/json` ê´€ë ¨
ìš”ì²­ ì˜ˆ) `@RequestBody HelloData data`
ì‘ë‹µ ì˜ˆ) `@ResponseBody return helloData` 
ì“°ê¸° ë¯¸ë””ì–´íƒ€ì… `application/json` ê´€ë ¨

```java
content-type: application/json
@RequestMapping
void hello(@RequestBody String data) {}
```
ë§Œì•½ ìœ„ì™€ê°™ì€ ì½”ë“œê°€ ì‹¤í–‰ëœë‹¤ë©´ `StringHttpMessageConverter` ì´ ì‹¤í–‰ëœë‹¤.

```java
content-type: application/json
@RequestMappingvoid 
hello(@RequestBody HelloData data) {}
```
ìœ„ì™€ ê°™ì€ ì½”ë“œê°€ ì‹¤í–‰ë˜ë©´  `MappingJackson2HttpMessageConverter` ì´ ì‹¤í–‰ëœë‹¤.

```java
content-type: text/html
@RequestMapping
void hello(@RequestBody HelloData data) {}
```
ë§ˆì§€ë§‰ìœ¼ë¡œ ìœ„ ì½”ë“œëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤. `application/json` í˜•ì‹ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì´ë‹¤.

> #### ğŸ“Œ ìš”ì²­ ë§¤í•‘ í—¨ë“¤ëŸ¬ ì–´ëí„° êµ¬ì¡°


![image](https://github.com/030831/030831.github.io/assets/101914089/538c8a2f-6d7f-4dc5-9002-eaeade832486)

ì´ì „ì— ìœ„ì™€ê°™ì€ ìŠ¤í”„ë§ `MVC` íŒ¨í„´ êµ¬ì¡°ë¥¼ ì‚´í´ë³´ì•˜ë‹¤.
ì§€ê¸ˆê¹Œì§€ ì•Œì•„ë³¸ `HTTP` ë©”ì‹œì§€ ì»¨ë²„í„°ëŠ” ì–´ë””ì¯¤ì— ìˆì„ê¹Œ?

ë°”ë¡œ `@RequestMapping` ì„ ì²˜ë¦¬í•˜ëŠ” í•¸ë“¤ëŸ¬ ì–´ëí„°ì¸ ìš”ì²­ ë§¤í•‘ í•¸ë“¤ëŸ¬ ì–´ëí„° `RequestMappingHandlerAdapter` ì— ìˆë‹¤.

![image](https://github.com/030831/030831.github.io/assets/101914089/e695d95c-17b2-48fc-b30d-0ae754fc9099)

ì´ì „ì— ìš”ì²­ê³¼ ì‘ë‹µì—ì„œ íŒ¨ë°ì„ í• ë•Œ íŒŒë¼ë¯¸í„°ì— `HttpServletRequest , Model , @RequestParam , @ModelAttirbute , @RequestBody , HttpEntity` ê°™ì€ ë§ì€ íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í–ˆë‹¤.

ì´ë ‡ê²Œ ìœ ì—°í•˜ê²Œ íŒŒë¼ë¯¸í„°ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì´ìœ ê°€ ë°”ë¡œ `ArgumentResolver` ë•ë¶„ì´ë‹¤.

`ArgumentResolver` ê°€ í•´ë‹¹ íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì›í•˜ëŠ”ì§€ ì²´í¬í•˜ê³  ê°€ëŠ¥í•œ í•¸ë“¤ëŸ¬ê°€ ê°ì²´ë¥¼ ìƒì„±í•´ ì»¨íŠ¸ë¡¤ëŸ¬ì—ê²Œ ì „ë‹¬í•´ì¤€ë‹¤.

`ReturnValueHandle` ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ `String` ìœ¼ë¡œ ë·° ì´ë¦„ì„ ë°˜í™˜í•´ë„ ë™ì‘í•˜ê²Œ í•˜ë„ë¡ ì§€ì›í•´ì¤€ë‹¤.

![image](https://github.com/030831/030831.github.io/assets/101914089/93703863-f9c6-437a-ba08-fe4aaf4b11a9)

ìš”ì²­ì˜ ê²½ìš° `@RequestBody` ë¥¼ ì²˜ë¦¬í•˜ëŠ” `ArgumentResolver` ê°€ ìˆê³  `HttpEntity` ë¥¼ ì²˜ë¦¬í•˜ëŠ” `ArgumentResolver` ê°€ ìˆë‹¤. ì´ `ArgumentResolver` ë“¤ì´ `HTTP` ë©”ì‹œì§€ ì»¨ë²„í„°ë¥¼ ì‚¬ìš©í•´ë„ í•„ìš”í•œ ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤.

ì‘ë‹µì˜ ê²½ìš° `@ResponseBody` ì™€ `HttpEntity` ë¥¼ ì²˜ë¦¬í•˜ëŠ” `ReturnValueHandler` ê°€ ìˆë‹¤. `ReturnValueHandler` ê°€ `HTTP` ë©”ì‹œì§€ ì»¨ë²„í„°ë¥¼ í˜¸ì¶œí•´ì„œ ì‘ë‹µ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.

