---
layout: post
title: "3. ì„œë¸”ë¦¿, JSP, MVC íŒ¨í„´"
categories: Gaounuri_Spring_Study
---

[Project Code File](https://github.com/030831/Java_Project/tree/master/servlet)


> ### ğŸ“Œ ëª©ì°¨

1. íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìš”êµ¬ì‚¬í•­

2. ì„œë¸”ë¦¿ìœ¼ë¡œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°

3. JSPë¡œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°

4. ì„œë¸”ë¦¿ê³¼ `JSP` ì˜ í•œê³„ì™€ `MVC` íŒ¨í„´ì˜ ë“±ì¥

5. `MVC` íŒ¨í„´ - ì ìš©

6. `MVC` íŒ¨í„´ - í•œê³„

> #### ğŸ“Œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ìš”êµ¬ì‚¬í•­

ê°„ë‹¨í•œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ì–´ ë³´ì.

ë¨¼ì € ì„œë¸”ë¦¿ì„ í†µí•´ ë§Œë“¤ì–´ ë³´ê³  , ì„œë¸”ë¦¿ì˜ í•œê³„ì ì„ ì‚´í´ë³¸í›„ì— ë” ë‚˜ì€ í•´ê²°ì±…ì¸ `JSP` ë¥¼ ì‚¬ìš©í•œë‹¤.

í•˜ì§€ë§Œ `JSP` ë¥¼ ì‚¬ìš©í•¨ì—ë„ ë¶ˆêµ¬í•˜ê³  ì—¬ì „íˆ ë¶ˆí¸í•œ ì ì´ ìƒê¸´ë‹¤. ê·¸ëŸ¬í•œ ì´ìœ ë¡œ ì¸í•´ `MVC` íŒ¨í„´ì´ ë°œìƒí•˜ê²Œ ë˜ëŠ”ë° ì´ë²ˆ í¬ìŠ¤íŒ…ì„ í†µí•´ `MVC` íŒ¨í„´ì´ ë°œìƒí•œ ë°°ê²½ì„ ì•Œì•„ë³¸ë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ `MVC` íŒ¨í„´ì˜ í•œê³„ì ì„ ì‚´í´ë³¸ë‹¤.

íšŒì›ì •ë³´ëŠ” ì´ë¦„ `username` , ë‚˜ì´ `age` ë¡œ êµ¬ì„±ë˜ì–´ìˆìœ¼ë©° ê¸°ëŠ¥ì€ íšŒì›ì €ì¥ê³¼ íšŒì›ëª©ë¡ ì¡°íšŒ 2ê°€ì§€ê°€ ì¡´ì¬í•œë‹¤.

```java
package hello.servlet.domain.member;

import lombok.Getter;
import lombok.Setter;

@Getter @Setter
public class Member {
    private Long id;
    private String username;
    private int age;

    public Member() {
    }

    public Member(String username, int age) {
        this.username = username;
        this.age = age;
    }
}
```

`lombok` ì„ í†µí•´ `getter,setter` ë¥¼ ì• ë…¸í…Œì´ì…˜ìœ¼ë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤.

```java
package hello.servlet.domain.member;

/**
 * ë™ì‹œì„± ë¬¸ì œê°€ ê³ ë ¤ë˜ì–´ ìˆì§€ ì•ŠìŒ , ì‹¤ë¬´ì—ì„œëŠ” ConcurrentHashMap , AtomicLong ê³ ë ¤
 */
public class MemberRepository {

    private static Map<Long, Member> store = new HashMap<>();
    private static long sequence = 0L;

    private static final MemberRepository instance = new MemberRepository(); // singleton

    private MemberRepository() {

    }

    public static MemberRepository getInstance() {
        return instance;
    }

    public Member save(Member member) {
        member.setId(++sequence);
        store.put(member.getId() , member);
        return member;
    }

    public Member findById(Long id) {
        return store.get(id);
    }

    public List<Member> findAll() {
        return new ArrayList<>(store.values());
    }

    public void clearStore() {
        store.clear();
    }
}
```

íšŒì›ì„ ì €ì¥í•˜ëŠ” `repository` ëŠ” `singleton` í˜•ì‹ì´ê³  ì €ì¥ê³¼ `findById` , ì „ì²´ ì°¾ê¸° , ì „ì²´ ì œê±°ê°€ ìˆë‹¤.

> #### ğŸ“Œ ì„œë¸”ë¦¿ìœ¼ë¡œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°

**ì„œë¸”ë¦¿ì„ í†µí•´ íšŒì›ë“±ë¡ `HTML` í¼ì„ ë§Œë“¤ì–´ ë³´ì.**

```java
package hello.servlet.web.servlet;

// http://localhost:8080/servlet/members/new-form

@WebServlet(name = "memberFormServlet", urlPatterns = "/servlet/members/new-form")
public class MemberFormServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        response.setContentType("text/html");
        response.setCharacterEncoding("utf-8");

        PrintWriter w = response.getWriter();

        /**
         * ìˆœìˆ˜ servlet ì„ ì‚¬ìš©í•˜ë©´ html ì„ ìë°”ì½”ë“œë¡œ ì‘ì„±í•´ì•¼í•˜ë¯€ë¡œ ë§¤ìš° ë¶ˆí¸í•˜ë‹¤.
         */
        w.write("<!DOCTYPE html>\n" +
            "<html>\n" +
            "<head>\n" +
            " <meta charset=\"UTF-8\">\n" +
            " <title>Title</title>\n" +
            "</head>\n" +
            "<body>\n" +
            "<form action=\"/servlet/members/save\" method=\"post\">\n" +
            " username: <input type=\"text\" name=\"username\" />\n" +
            " age: <input type=\"text\" name=\"age\" />\n" +
            " <button type=\"submit\">ì „ì†¡</button>\n" +
            "</form>\n" +
            "</body>\n" +
            "</html>\n");
    }
}
```

ì„œë¸”ë¦¿ì„ ì‚¬ìš©í•˜ë©´ ìë°” ì½”ë“œ ì•ˆì— `HTML` ì½”ë“œë¥¼ ì“¸ ìˆ˜ ìˆë‹¤.
**ìˆœìˆ˜í•œ ì„œë¸”ë¦¿ì€ ë§¤ìš° ë¶ˆí¸í•œë‹¤ëŠ” ì ì„ ì•Œ ìˆ˜ ìˆë‹¤.**

![image](https://github.com/030831/030831.github.io/assets/101914089/774a5a4f-5232-4f9f-b96b-94bfa39207e1)

`HTML` í™”ë©´ì€ ìœ„ì™€ ê°™ë‹¤.

**ì´ì œ ë™ì ìœ¼ë¡œ íšŒì› ì €ì¥ ì½”ë“œë¥¼ ë§Œë“¤ì–´ ë³´ì.**

```java
package hello.servlet.web.servlet;

// http://localhost:8080/servlet/members/new-form

@WebServlet(name = "memberSaveServlet" , urlPatterns = "/servlet/members/save")
public class MemberSaveServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.out.println("MemberSaveServlet.service");
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age")); // getParameter ì˜ ë°˜í™˜ê°’ì€ í•­ìƒ Stringì´ë‹¤.

        Member member = new Member(username , age);
        memberRepository.save(member);

        response.setContentType("text/html");
        response.setCharacterEncoding("utf-8");

        PrintWriter w = response.getWriter();

        /**
         * ë™ì ì¸ html ì½”ë“œ. ì¤‘ê°„ì— ìë°” ì½”ë“œë¥¼ í†µí•´ ë™ì ìœ¼ë¡œ htmlì— ë³€í™”ë¥¼ ì¤„ ìˆ˜ ìˆë‹¤.
         */
        w.write("<html>\n" +
            "<head>\n" +
            " <meta charset=\"UTF-8\">\n" +
            "</head>\n" +
            "<body>\n" +
            "ì„±ê³µ\n" +
            "<ul>\n" +
            " <li>id="+member.getId()+"</li>\n" +
            " <li>username="+member.getUsername()+"</li>\n" + " <li>age="+member.getAge()+"</li>\n" +
            "</ul>\n" +
            "<a href=\"/index.html\">ë©”ì¸</a>\n" +
            "</body>\n" +
            "</html>");
    }
}
```

ì´ì „ì— ë§Œë“  `MemberRepository` ê°ì²´ë¥¼ ê°€ì ¸ì˜¤ê³  `request` ë¥¼ í†µí•´ íŒŒë¼ë¯¸í„°ë¥¼ ì „ë‹¬ ë°›ì€ ë’¤ì— `MemberRepository` ì— ì €ì¥í•œë‹¤.

ê·¸ë¦¬ê³  ì„œë¸”ë¦¿ì„ í†µí•´ ìë°” ì½”ë“œì— `HTML` ì„ ë„£ìŒìœ¼ë¡œì¨ ì¤‘ê°„ì— `member.getId()` ì™€ ê°™ì€ ë°ì´í„° ì •ë³´ë¥¼ í•¨ê»˜ ì¶œë ¥í•˜ë©´ì„œ **ë™ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜**ì„ ì‹¤í–‰í•œë‹¤.

![image](https://github.com/030831/030831.github.io/assets/101914089/d581103a-477e-4f1b-87e3-489017a1e8ab)

`HTML form` ì—ì„œ ì´ë¦„ê³¼ ë‚˜ì´ë¥¼ ì…ë ¥í•˜ë©´ ìœ„ì™€ê°™ì€ ì¶œë ¥ ê²°ê³¼ê°€ ë‚˜ì˜¤ê²Œ ëœë‹¤.

**ì´ì œ ì €ì¥í•œ íšŒì›ì˜ ëª©ë¡ì„ ì¡°íšŒí•˜ëŠ” ì½”ë“œë¥¼ ë§Œë“¤ì–´ ë³´ì.**

```java
package hello.servlet.web.servlet;

// http://localhost:8080/servlet/members

@WebServlet(name = "memberListServlet" , urlPatterns = "/servlet/members")
public class MemberListServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        List<Member> members = memberRepository.findAll(); // ì „ì²´ ë°ì´í„° ì¡°íšŒ

        response.setContentType("text/html");
        response.setCharacterEncoding("utf-8");

        PrintWriter w = response.getWriter();

        w.write("<html>");
        w.write("<head>");
        w.write(" <meta charset=\"UTF-8\">");
        w.write(" <title>Title</title>");
        w.write("</head>");
        w.write("<body>");
        w.write("<a href=\"/index.html\">ë©”ì¸</a>");
        w.write("<table>");
        w.write(" <thead>");
        w.write(" <th>id</th>");
        w.write(" <th>username</th>");
        w.write(" <th>age</th>");
        w.write(" </thead>");
        w.write(" <tbody>");
        /*
         w.write(" <tr>");
         w.write(" <td>1</td>");
         w.write(" <td>userA</td>");
         w.write(" <td>10</td>");
         w.write(" </tr>");
        */
        for (Member member : members) {
            w.write(" <tr>");
            w.write(" <td>" + member.getId() + "</td>");
            w.write(" <td>" + member.getUsername() + "</td>"); w.write(" <td>" + member.getAge() + "</td>");
            w.write(" </tr>");
        }
        w.write(" </tbody>");
        w.write("</table>");
        w.write("</body>");
        w.write("</html>");

    }
}
```

![image](https://github.com/030831/030831.github.io/assets/101914089/f397a65c-6ed8-40c9-a18e-d44ffa03e6d1)



ìˆœìˆ˜í•˜ê²Œ ì„œë¸”ë¦¿ë§Œì„ ì‚¬ìš©í•´ì„œ íšŒì› ì €ì¥ , íšŒì›ëª©ë¡ì¡°íšŒê¸°ëŠ¥ì„ ê°€ì§„ ë™ì  ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ì—ˆë‹¤.

í•˜ì§€ë§Œ ì½”ë“œë¥¼ ë³´ë©´ ë¶ˆí¸í•œ ì ì´ ì•„ì£¼ ì•Šë‹¤.
ìë°” ì½”ë“œë¡œ `HTML` ì½”ë“œë¥¼ ì§œëŠ”ê²ƒ ìì²´ê°€ ë§¤ìš° ë²ˆê±°ë¡­ë‹¤. ì°¨ë¼ë¦¬ `HTML` ë¬¸ì„œì— ë™ì ìœ¼ë¡œ ë³€ê²½í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ë§Œ ìë°” ì½”ë“œë¥¼ ë„£ëŠ” ê²ƒì´ ì–´ë–¨ê¹Œ?

ì´ë¥¼ í•´ê²°í•˜ëŠ”ê²ƒì´ ë°”ë¡œ í…œí”Œë¦¿ ì—”ì§„ì´ë‹¤. í…œí”Œë¦¿ ì—”ì§„ì—ëŠ” `JSP, Thymeleaf, Freemarker, Velocity` ë“±ì´ ìˆë‹¤.

ì´ë²ˆì—ëŠ” `JSP` ë¥¼ í†µí•´ ì¢€ ë” ê°„ê²°í•œ ì½”ë“œë¥¼ ì§œë³´ì.

> #### ğŸ“Œ JSPë¡œ íšŒì› ê´€ë¦¬ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë§Œë“¤ê¸°

`JSP` ë€ `Java Server Pages` ë¡œì¨  ìë°”ë¥¼ ì›¹ì„œë²„ì—ì„œ ì‰½ê²Œ ì“°ê¸° ìœ„í•œ ê¸°ìˆ ì´ë©° ì–¸ì–´ê°€ ì•„ë‹ˆë‹¤. `JSP` ë¥¼ ì‚¬ìš©í•œë‹¤ë©´ `HTML` ì½”ë“œ ì•ˆì— ìë°” ì½”ë“œë¥¼ ë„£ì„ ìˆ˜ ìˆë‹¤.

ìë°” ì½”ë“œì— `HTML` ì½”ë“œë¥¼ ë„£ëŠ” `Servlet` ê³¼ëŠ” ë°˜ëŒ€ë˜ëŠ” ê°œë…ì´ë‹¤.

```java
// build.gradle
//JSP ì¶”ê°€ ì‹œì‘
implementation 'org.apache.tomcat.embed:tomcat-embed-jasper'
implementation 'javax.servlet:jstl'
//JSP ì¶”ê°€ ë
```

`jsp` ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„  `build.gradle` ê²½ë¡œì— ìœ„ì™€ ê°™ì€ ì½”ë“œë¥¼ ì¶”ê°€í•´ì£¼ì–´ì•¼ í•œë‹¤.

**íšŒì›ì„ ë“±ë¡í•˜ëŠ” `HTML form` ì„ ë§Œë“¤ì–´ ë³´ì.**

```HTML
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
 <title>Title</title>
</head>
<body>
<form action="/jsp/members/save.jsp" method="post">
 username: <input type="text" name="username" /> age: <input type="text" name="age" />
 <button type="submit">ì „ì†¡</button>
</form>
</body>
</html>
```

ì²«ë²ˆì§¸ ì¤„ì— ìˆëŠ” ë‚´ìš©ì€ `jsp` ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” ê¼­ ì ì–´ì£¼ì–´ì•¼ í•œë‹¤.
ë˜í•œ `HTML` í™”ë©´ ê²°ê³¼ëŠ” `Servlet` ì—ì„œ ë§Œë“  `HTML form` í˜•ì‹ê³¼ ë™ì¼í•˜ë‹¤.

**ì´ì œ íšŒì›ì„ ì €ì¥í•˜ëŠ” `JSP` íŒŒì¼ì„ ë§Œë“¤ì–´ ë³´ì.**


```java
<%@ page import="hello.servlet.domain.member.Member" %>
<%@ page import="hello.servlet.domain.member.MemberRepository" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%
    // request , response ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ê°€ëŠ¥.
    MemberRepository memberRepository = MemberRepository.getInstance();

    System.out.println("MemberSaveServlet.service");
    String username = request.getParameter("username");
    int age = Integer.parseInt(request.getParameter("age")); // getParameter ì˜ ë°˜í™˜ê°’ì€ í•­ìƒ String ì´ë‹¤.

    Member member = new Member(username , age);
    memberRepository.save(member);
%>
<html>
<head>
    <title>Title</title>
</head>
<body>
ì„±ê³µ
<ul>
    <li>id=<%=member.getId()%></li>
    <li>username=<%=member.getUsername()%></li>
    <li>age=<%=member.getAge()%></li>
</ul>
<a href = "/index.html">ë©”ì¸</a>
</body>
</html>
```

ìœ„ ì½”ë“œë¥¼ ë³´ë©´ `Servlet` ìœ¼ë¡œ ì‘ì„±í•œ ì½”ë“œë³´ë‹¤ í›¨ì”¬ ë” ëª…í™•í•˜ê³  ê¹”ë”í•˜ë‹¤.

ìë°” ì½”ë“œëŠ” ìƒë‹¨ì— ë°°ì¹˜í•˜ê³  `HTML` ì½”ë“œëŠ” í•˜ë‹¨ì— ë°°ì¹˜í•¨ìœ¼ë¡œì¨ **ë¶„ë¦¬ê°€ ê°€ëŠ¥í•´ì¡Œê³ **
`<li>id=<%=member.getId()%></li>` ì™€ ê°™ì€ `JSP` ë¬¸ë²•ì„ í†µí•´ ë™ì  ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°„ë‹¨ëª…ë£Œí•˜ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

**ì´ì œ íšŒì› ëª©ë¡ì„ ì¶œë ¥í•˜ëŠ” `JSP` íŒŒì¼ì„ ë§Œë“¤ì–´ ë³´ì.**

```java
<%@ page import="hello.servlet.domain.member.MemberRepository" %>
<%@ page import="hello.servlet.domain.member.Member" %>
<%@ page import="java.util.List" %>
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%
    MemberRepository memberRepository = MemberRepository.getInstance();
    List<Member> members = memberRepository.findAll(); // ì „ì²´ ë°ì´í„° ì¡°íšŒ
%>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<a href="/index.html">ë©”ì¸</a>
<table>
    <thead>
    <th>id</th>
    <th>username</th>
    <th>age</th>
    </thead>
    <tbody>
    <%
        for (Member member : members) {
            out.write(" <tr>");
            out.write(" <td>" + member.getId() + "</td>");
            out.write(" <td>" + member.getUsername() + "</td>");
            out.write(" <td>" + member.getAge() + "</td>");
            out.write(" </tr>");
        }
    %>
    </tbody>
</table>
</body>
</html>
```

ì´ë²ˆì—ë„ ìë°” ì½”ë“œì™€ `HTML` ì½”ë“œì˜ ë¶„ë¦¬ê°€ ëª…í™•í•˜ë‹¤.
í•˜ì§€ë§Œ ì•„ì§ê¹Œì§€ë„ ì½”ë“œì— ë¶ˆí¸í•œ ì ì´ ì—¬ì „íˆ ëª‡ê°€ì§€ê°€ ë³´ì¸ë‹¤.

> #### ğŸ“Œ ì„œë¸”ë¦¿ê³¼ JSPì˜ í•œê³„ì™€ MVC íŒ¨í„´ì˜ ë“±ì¥

ì„œë¸”ë¦¿ìœ¼ë¡œ ê°œë°œí• ë•ŒëŠ” `HTML` ì„ ë§Œë“œëŠ” ì‘ì—…ì´ ìë°” ì½”ë“œë•Œë¬¸ì— ì§€ì €ë¶„í•˜ê³  ë³µì¡í–ˆë‹¤.
`JSP` ë¥¼ ì‚¬ìš©í•œ ë•ë¶„ì— ìë°” ì½”ë“œì™€ `HTML` ì½”ë“œë¥¼ ë¶„ë¦¬í•¨ìœ¼ë¡œì¨ ì–´ëŠì •ë„ ê¹”ë”í•´ì¡Œë‹¤.

í•˜ì§€ë§Œ ì½”ë“œë¥¼ ì˜ë³´ë©´ `JSP` íŒŒì¼ í•˜ë‚˜ì— `HTML` ì½”ë“œì™€ `java` ì½”ë“œê°€ ëª¨ë‘ ë…¸ì¶œë˜ì–´ìˆë‹¤.

ë§Œì•½ì— ìˆ˜ë°± , ìˆ˜ì²œì¤„ì´ ë„˜ëŠ” `JSP` íŒŒì¼ì— `HTML` ì½”ë“œë¥¼ ì¼ë¶€ë¶„ë§Œ ìˆ˜ì •í•´ì•¼í•œë‹¤ë©´ ì–´ë–¨ê¹Œ?
ê·¸ë•Œ ë§Œì•½ `java` ì½”ë“œë•Œë¬¸ì— ì˜ˆê¸°ì¹˜ ëª»í•œ ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ?

ë˜í•œ ì•„ì£¼ ì‚¬ì†Œí•œ ì‘ì—… ( ë²„íŠ¼ì˜ ìœ„ì¹˜ë³€ê²½ ) ì„ í•˜ê¸° ìœ„í•´ì„œ ìë°” ì½”ë“œì™€ `HTML` ì½”ë“œê°€ ì„ì¸ ìƒí™©ì—ì„œ `HTML` ì½”ë“œ ë¿ë§Œ ì•„ë‹ˆë¼ ìë°”ì½”ë“œê¹Œì§€ ê°™ì´ ìˆ˜ì •í•´ì•¼í•œë‹¤ë©´ ì¼ì´ ë³µì¡í•´ì§€ì§€ì•Šì„ê¹Œ?

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ `MVC` íŒ¨í„´ì´ ë“±ì¥í–ˆë‹¤.

í˜„ì¬ ë¬¸ì œì ì„ ì •ë¦¬í•˜ìë©´ `JSP` ì— ë„ˆë¬´ë§ì€ ì—­í• ì´ ì¡´ì¬í•˜ëŠ” ê²ƒì´ê³ 
ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ê³¼ `UI` ìˆ˜ì •ê°™ì€ ì‘ì—…ì´ ê°ê° ë‹¤ë¥´ê²Œ ë°œìƒí• í…ë° `JSP` ë¡œ ì¸í•´ ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ê³¼ `UI` ìˆ˜ì •ì‘ì—…ì´ ë™ì‹œì— ë°œìƒí•œë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ `JSP` ëŠ” í™”ë©´ì„ ë Œë”ë§ í•˜ëŠ”ë° ìµœì í™” ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ì´ ë¶€ë¶„ì˜ ê¸°ëŠ¥ë§Œ ë‹´ë‹¹í•˜ëŠ”ê²ƒì´ ê°€ì¥ íš¨ê³¼ì ì´ë‹¤.


![image](https://github.com/030831/030831.github.io/assets/101914089/4f7a6821-d8b9-4bb0-9f80-9b8f26424706)


`MVC` ëŠ” `model , view , controller` ë¡œ ë‚˜ë‰œë‹¤.


* ì»¨íŠ¸ë¡¤ëŸ¬ : `HTTP` ìš”ì²­ì„ ë°›ì•„ì„œ íŒŒë¼ë¯¸í„°ë¥¼ ê²€ì¦í•˜ê³  ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì„ ì‹¤í–‰í•œë‹¤. ê·¸ë¦¬ê³  ëª¨ë¸ , ë·°ë¥¼ ì—…ë°ì´íŠ¸ í•œë‹¤.


* ëª¨ë¸ : ë·°ì— ì¶œë ¥í•  ë°ì´í„°ë¥¼ ë‹´ëŠ”ë‹¤. ì´ë¡œì¸í•´ ë·°ëŠ” ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ì´ë‚˜ ë°ì´í„°ì— ëŒ€í•´ ëª°ë¼ë„ ë˜ê³  í™”ë©´ì„ ë Œë”ë§í•˜ëŠ” ì¼ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆë‹¤.

* ë·° : ëª¨ë¸ì— ìˆëŠ” ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ì„œ í™”ë©´ì„ ì¶œë ¥í•˜ëŠ” ì¼ì„ ë‹´ë‹¹í•œë‹¤.

> #### ğŸ“Œ MVC íŒ¨í„´ - ì ìš©

ì„œë¸”ë¦¿ì„ `Controller` ë¡œ ì‚¬ìš©í•˜ê³  `jsp` ë¥¼ `view` ë¡œ ì‚¬ìš©í•´ì„œ `MVC` íŒ¨í„´ì„ ì‚¬ìš©í•´ë³´ì.

`Model` ì€ `HttpServletRequest` ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤. 
`request.setAttribute() , request.getAttribute()` ë¥¼ ì‚¬ìš©í•˜ë©´ ë°ì´í„°ë¥¼ ë³´ê´€í•˜ê³  , ì €ì¥í•  ìˆ˜ ìˆë‹¤.

**íšŒì› ë“±ë¡ í¼ì„ ë§Œë“¤ì–´ ë³´ì.**

```java
package hello.servlet.web.servletmvc;

@WebServlet( name = "mvcMemberFormServlet" , urlPatterns ="/servlet-mvc/members/new-form")
public class MvcMemberFormServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String viewPath = "/WEB-INF/views/new-form.jsp";
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request , response); // ë¦¬ë‹¤ì´ë ‰íŠ¸ê°€ ì•„ë‹˜
    }
}
```

`dispatcher.forward()` ì€ ë‹¤ë¥¸ ì„œë¸”ë¦¿ì´ë‚˜ `JSP` ë¡œ ì´ë™í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ë‹¤.
ì„œë²„ ë‚´ë¶€ì—ì„œ ë‹¤ì‹œ í˜¸ì¶œì´ ë°œìƒí•˜ë¯€ë¡œ `redirection` ê³¼ëŠ” ë‹¤ë¥¸ ê¸°ëŠ¥ì´ë‹¤.

ì´ë•Œ ê²½ë¡œë¥¼ `/WEB-INF/~` ë¡œ ì§€ì •í•´ì£¼ì—ˆëŠ”ë° ì´ ê²½ë¡œì— ìˆë‹¤ë©´ ì™¸ë¶€ì—ì„œ `jsp` ë¥¼ ì§ì ‘ í˜¸ì¶œí• ìˆ˜ ì—†ë‹¤.
ì¦‰ `localhost:8080/WEB-INF/~` ë¡œ `http` ìš”ì²­ì„ í•´ë„ `jsp` íŒŒì¼ì„ ë³¼ ìˆ˜ ì—†ë‹¤.
ì´ë¡œì¸í•´ì„œ `jsp` ëŠ” í•­ìƒ ì»¨íŠ¸ë¡¤ëŸ¬ì— ì˜í•´ì„œë§Œ í˜¸ì¶œì´ ëœë‹¤.

```HTML
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<!-- ìƒëŒ€ê²½ë¡œ ì‚¬ìš©, [í˜„ì¬ URL ì´ ì†í•œ ê³„ì¸µ ê²½ë¡œ + /save] -->
<form action="save" method="post">
  username: <input type="text" name="username" />
  age: <input type="text" name="age" />
  <button type="submit">ì „ì†¡</button>
</form>
</body>
</html>
```
íšŒì›ë“±ë¡ í¼ `HTML` ì€ ì´ì „ì— `jsp` ì—ì„œ ì‚¬ìš©í–ˆë˜ ê²ƒì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í–ˆë‹¤.
ì´ë•Œ ê²½ë¡œë¥¼ ìƒëŒ€ê²½ë¡œë¡œ ì„¤ì •í•´ì£¼ì—ˆë‹¤. 

**ì´ì œ íšŒì›ì €ì¥ ì½”ë“œë¥¼ ë§Œë“¤ì–´ë³´ì.**

```java
package hello.servlet.web.servletmvc;


@WebServlet(name = "mvcMemberSaveServlet" , urlPatterns = "/servlet-mvc/members/save")
public class MvcMemberSaveServlet extends HttpServlet {

    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age")); // getParameter ì˜ ë°˜í™˜ê°’ì€ í•­ìƒ Stringì´ë‹¤.

        Member member = new Member(username , age);
        memberRepository.save(member);

        // Model ì— ë°ì´í„°ë¥¼ ë³´ê´€í•œë‹¤.
        request.setAttribute("member", member);

        String viewPath = "/WEB-INF/views/save-result.jsp";
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request , response);
    }
}
```

íšŒì› ì €ì¥ ì½”ë“œë„  ê²½ë¡œ ì €ì¥ê³¼ `dispatcher` ë¶€ë¶„ì„ ì œì™¸í•˜ê³  ë™ì¼í•˜ë‹¤.

```HTML
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <title>Title</title>
</head>
<body>
ì„±ê³µ
<ul>
    <li>id=${member.id}</li>
    <li>username=${member.username}</li>
    <li>age=${member.age}</li>

</ul>
<a href = "/index.html">ë©”ì¸</a>
</body>
</html>
```

í•˜ì§€ë§Œ ì´ì œ íšŒì› ì €ì¥ì„ í•˜ëŠ” **ìë°” ì½”ë“œì™€ `HTML` ì½”ë“œì™€ ì™„ë²½í•˜ê²Œ ë¶„ë¦¬ë˜ì—ˆë‹¤.**

ì´ì œ **ë¹„ì§€ë‹ˆìŠ¤ ë¡œì§ë³€ê²½ì´ í•„ìš”í• ë• `HTML` ì½”ë“œë¥¼ ìˆ˜ì •í•  í•„ìš”ê°€ ì—†ì–´ì§€ê²Œ ë˜ì—ˆë‹¤.**
ë˜í•œ `JSP` ëŠ” `${}` ë¬¸ë²•ì„ ì œê³µí•˜ëŠ”ë°, ì´ ë¬¸ë²•ì„ ì‚¬ìš©í•˜ë©´ `request` ì˜ `attribute` ì— ë‹´ê¸´ ë°ì´í„°ë¥¼ í¸ë¦¬í•˜ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

**ì´ì œ íšŒì› ëª©ë¡ ì¡°íšŒ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ë·°ë¥¼ ë§Œë“¤ì–´ ë³´ì.**

```java
package hello.servlet.web.servletmvc;

@WebServlet(name = "mvcMemberListServlet" , urlPatterns = "/servlet-mvc/members")
public class MvcMemberListServlet extends HttpServlet {
    private MemberRepository memberRepository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        List<Member> members = memberRepository.findAll();
        request.setAttribute("members", members);

        String viewPath = "/WEB-INF/views/members.jsp";
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);

        dispatcher.forward(request , response);
    }
}
```

`List<Member> members = memberRepository.findAll();` ë¡œ íšŒì› ëª©ë¡ì„ ì¡°íšŒí•˜ê³  `request` ì— `setAttribute()` ë©”ì„œë“œë¥¼ í†µí•´ ì €ì¥í•´ì£¼ì—ˆë‹¤.

```HTML
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<html>
<head>
  <meta charset="UTF-8">
  <title>Title</title>
</head>
<body>
<a href="/index.html">ë©”ì¸</a>
<table>
  <thead>
  <th>id</th>
  <th>username</th>
  <th>age</th>
  </thead>
  <tbody>
  <c:forEach var="item" items="${members}">
    <tr>
      <td>${item.id}</td>
      <td>${item.username}</td>
      <td>${item.age}</td>
    </tr>
  </c:forEach>
  </tbody>
</table>
</body>
</html>
```

ë§Œì•½ì— ë¦¬ìŠ¤íŠ¸ í˜•ì‹ì´ê³  ëª¨ë‘ ì¶œë ¥í•˜ê¸° ìœ„í•´ì„œ `for` ë¬¸ì„ `HTML` ì½”ë“œì—ì„œ ì¨ì•¼í• ë•ŒëŠ”

`<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>` ì„ ì¶”ê°€í•˜ë©´ `forEach` ë¬¸ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

ì§€ê¸ˆê¹Œì§€ `MVC` íŒ¨í„´ì„ ì ìš©í•´ë³´ì•˜ë‹¤.

ì»¨íŠ¸ë¡¤ëŸ¬ `java` ì™€ ë·° `HTML` ë¥¼ ë¶„ë¦¬í•¨ìœ¼ë¡œì¨ `jsp` ì— ë¹„í•´ ì½”ë“œê°€ ë” ëª…í™•í•˜ê³  ê¹”ë”í•´ì¡Œë‹¤. ë”ë¶ˆì–´ì„œ ìœ ì§€ë³´ìˆ˜ë„ í¸ë¦¬í•´ì¡Œë‹¤.

> #### ğŸ“Œ MVC íŒ¨í„´ - í•œê³„

`MVC` íŒ¨í„´ì„ ì ìš©í•œ ë•ë¶„ì— ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì—­í• ê³¼ ë·°ë¥¼ ë Œë”ë§ í•˜ëŠ” ì—­í• ì„ ëª…í™•í•˜ê²Œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.
ê·¸ëŸ°ë° ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” ì¤‘ë³µ ì½”ë“œê°€ ë§ì´ ë°œìƒí•˜ê³  í•„ìš”í•˜ì§€ ì•ŠëŠ” ì½”ë“œê°€ ëª‡ëª‡ ë³´ì¸ë‹¤.

```java
RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
dispatcher.forward(request , response);
```

`view` ë¡œ ì´ë™í•˜ëŠ” ì½”ë“œê°€ í•­ìƒ ì¤‘ë³µë˜ì–´ ë‚˜íƒ€ë‚œë‹¤. ì´ë¥¼ ë©”ì„œë“œë¡œ ë”°ë¡œ ë§Œë“¤ìˆœ ìˆì§€ë§Œ ë§¤ë²ˆ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•´ì•¼í•˜ë©° ì‹¤ìˆ˜ë¡œ í˜¸ì¶œí•˜ì§€ ì•Šì•˜ì„ë•Œ í° ì˜¤ë¥˜ê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.


```java
String viewPath = "/WEB-INF/views/members.jsp"
```

ë‘ë²ˆì§¸ë¡œ ê²½ë¡œì— ì¤‘ë³µì´ ë°œìƒí•œë‹¤. `WEB-INF` ê²½ë¡œëŠ” í•­ìƒ í•„ìˆ˜ì ì´ë‹¤.
ë˜í•œ ë§Œì•½ `jsp` ê°€ ì•„ë‹ˆë¼ `thymeleaf` ê°™ì€ ë‹¤ë¥¸ ë·°ë¡œ ë³€ê²½í•œë‹¤ë©´ ì½”ë“œë¥¼ ì „ë¶€ ìˆ˜ì •í•´ì•¼í•œë‹¤.

```java
HttpServletRequest request, HttpServletResponse response
```

ì„¸ë²ˆì§¸ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šì€ ì½”ë“œê°€ ë°œìƒí•œë‹¤. `dispatcher` ë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ `response` ëŠ” ì‚¬ìš©í•˜ì§€ ì•Šê²Œ ë˜ì—ˆë‹¤. ì´ë¡œì¸í•´ `HttpServletResponse` ë¥¼ ì‚¬ìš©í•˜ëŠ” ì½”ë“œëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•˜ê¸°ë„ ì–´ë µë‹¤ëŠ” ë¬¸ì œì ì´ ìƒê¸´ë‹¤.

ê²°ë¡ ì ìœ¼ë¡œ ê³µí†µì ì¸ ì²˜ë¦¬ê°€ ì–´ë ¤ì›Œì§„ë‹¤.
ê¸°ëŠ¥ì´ ë³µì¡í•´ì ¸ì„œ ì»¨íŠ¸ë¡¤ëŸ¬ì— ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ë¶€ë¶„ì´ ì¦ê°€í•˜ê²Œ ëœë‹¤ë©´ ê·¸ ë¶€ë¶„ì„ ë©”ì„œë“œë¡œë½‘ì•„ì„œ ì“¸ ìˆ˜ ìˆì§€ë§Œ **ì—¬ì „íˆ ì¤‘ë³µì½”ë“œê°€ ë°œìƒí•˜ê²Œ ëœë‹¤.**

ë”°ë¼ì„œ ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œ ì „ì— ë¨¼ì € ê³µí†µê¸°ëŠ¥ì„ ì²˜ë¦¬í•´ì•¼í•œë‹¤.
ì´ë¥¼ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ `Front Controller` íŒ¨í„´ì´ë¼ê³  í•œë‹¤. 
